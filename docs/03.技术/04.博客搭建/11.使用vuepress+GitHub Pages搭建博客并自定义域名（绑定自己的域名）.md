---
title: 使用vuepress+GitHub Pages搭建博客并自定义域名（绑定自己的域名）
date: 2024-10-01 23:27:13
permalink: /pages/81a2f0/
categories:
  - 技术
  - 博客搭建
tags:
  - 
author: 
  name: czb
  link: https://github.com/xiake23
---
# 使用vuepress+GitHub Pages搭建博客并自定义域名（绑定自己的域名）

## 前言

本篇内容主要内容为使用GitHub Pages搭建静态页并绑定自定义域名，所以这里对于博客的搭建配置涉及内容不多。

## 一、vuepress博客搭建

​	[vuepress-theme-vdoing (xugaoyi.com)](https://doc.xugaoyi.com/)是[VuePress v1.x (opens new window)](https://vuepress.vuejs.org/zh/)的一个主题，是在[默认主题 (opens new window)](https://vuepress.vuejs.org/zh/theme/option-api.html)基础上做的修改和扩展，很多配置仍然沿用[官方配置 (opens new window)](https://vuepress.vuejs.org/zh/config/)。使用本主题可以很方便的搭建一个结构化的知识库或博客。本博客采用Vdoing主体搭建博客，对于相关的资料可以通过该主题的文档站以及vuepress的文档站进行查询，

也可以根据此博客查考搭建：[一篇带你用 VuePress + Github Pages 搭建博客_JavaScript_冴羽_InfoQ写作社区](https://xie.infoq.cn/article/4d2f62c87d188331342e62563)



## 二、使用GitHub Pages部署静态页面

### 2.1配置base路径

对于vuepress应用，可以在路径***docs/.vuepress/config.js***下添加***base***路径配置以添加全站路径后缀

```javascript
module.exports = {
    // 路径名为 "/<REPO>/"
    base: '/learn-typescript/',
    //...
}

```

对于当前的vuepress-theme-vdoing主题，该配置为***docs/.vuepress/config.ts***，可以在export模块中添加相应配置

![image-20241001233712291](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241001233712291.png)

如配置为/blog/，那么全站的静态资源相对路径前面就会加上/blog/

![image-20241001233807406](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241001233807406.png)

对于使用GitHub Pages部署且不绑定自定义域名的仓库来说，GitHub Pages的访问路径为***http(s)://<用户名>.github.io/<仓库名>***，当访问***/<仓库名>***该路径时会优先访问本项目指定分支下根目录***index.html*** 文件（如上图），而vuepress编译后的静态文件路径会添加上我们配置的base路径，比如此时本项目名为***thenook-blog***，那么我们配置***base***为***/thenook-blog/*** (注意前后斜杠不可缺省)

### 2.2添加部署脚本

进入项目根路径，我们添加一个deploy.sh 脚本文件（vdoing项目已经写好了），内容如下：

```shell
#!/usr/bin/env sh

# 确保脚本抛出遇到的错误
set -e


push_addr=`git remote get-url --push origin` # git提交地址，也可以手动设置，比如：push_addr=git@github.com:xugaoyi/vuepress-theme-vdoing.git
commit_info=`git describe --all --always --long`
dist_path=docs/.vuepress/dist # 打包生成的文件夹路径
push_branch=gh-pages # 推送的分支

# 生成静态文件  windows系统下需要使用build:win 命令编译，Linux下使用build命令即可
npm run build:win

# 进入生成的文件夹
cd $dist_path

git init
git add -A
git commit -m "deploy, $commit_info"
git push -f $push_addr HEAD:$push_branch

cd -
rm -rf $dist_path

```

执行时注意，***Windows系统需要使用build:win 命令编译，Linux下使用build命令即可***，而在Windows系统中，cmd是不能直接执行shell脚本的，Git Bash是Git for Windows的一部分，它提供了一个Bash环境，可以用来执行shell脚本。

进入项目仓库路径，我们执行新添加的脚本

![image-20241001234857248](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241001234857248.png)

编译推送成功之后，我们可以在项目的git分支上看到多了一个***gh-pages***分支，此时分支上即是我们编译后生成的静态资源文件

![image-20241001235031520](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241001235031520.png)



此时打开项目的Setting-Pages配置项，即可看到咱们部署成功且可以看到相应的github Pages访问路径

![image-20241001235559354](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241001235559354.png)





## 三、使用自定义域名根目录访问

对于GitHub Pages部署的应用，GitHub允许用户添加自定义的域名进行访问，如本站的blog.9ok.fun 且***不需要添加仓库名***（如上面的 [thenook-blog] ）作为路径

### 3.1 在账户中添加顶级域名



### 3.2 在域名注册商（DNS解析）配置A记录指向GitHub



### 3.3 在需要绑定域名的项目重新配置文件访问路径，取消资源的目录前缀



### 3.4 重新部署



### 3.5 在仓库Pages项添加自定义域名

![image-20241002011116721](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241002011116721.png)

### 3.6 在域名注册商（DNS解析）配置CNAME记录指向GitHub Pages



### 3.7 防止重新部署导致CNAME记录绑定失败

![image-20241002011141937](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241002011141937.png)

![image-20241002011200251](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241002011200251.png)

![image-20241002011215706](https://jsd.cdn.zzko.cn/gh/xiake23/PicGo-Images/note/image-20241002011215706.png)



